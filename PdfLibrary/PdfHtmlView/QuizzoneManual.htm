<!--
============================================================
  Akshat Network Hub - Universal PDF Viewer (Print-Protected Final)
  Author   : Akshat Prasad
  Identity : Akshat Network | Open Web Initiative
  Purpose  : Dual-Watermark PDF Viewer + Strict Print Restriction
  License  : MIT
============================================================
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <script src="/LearningClub-Key-of-Success-Learning-Point/lock_iframe_view.js" async></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quizzone Project Manual Book | Secure PDF Viewer</title>

  <style>
    body {
      margin: 0;
      background: #f4f6fa;
      font-family: "Inter", sans-serif;
      overflow-x: hidden;
      transition: background 0.5s ease, color 0.5s ease;
    }
    header {
      background: #0b4f6c;
      color: #fff;
      text-align: center;
      padding: 14px;
      font-weight: 600;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    #pdf-viewer {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 25px;
      transition: background 0.3s ease;
    }
    canvas {
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      border-radius: 8px;
      background: #fff;
      max-width: 95%;
      height: auto;
    }

    /* Floating Toolbar */
    .toolbar {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: row;
      background: #0b4f6c;
      border-radius: 40px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
      padding: 6px 10px;
      z-index: 1000;
    }
    .toolbar button {
      background: transparent;
      border: none;
      color: white;
      font-size: 18px;
      margin: 0 6px;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .toolbar button:hover {
      transform: scale(1.2);
    }

    /* Status Overlay */
    #status-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      color: #fff;
      display: none;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 2000;
    }
    .status-box {
      background: #fff;
      color: #222;
      padding: 20px 30px;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.4);
      text-align: center;
      width: 280px;
    }
    .status-step {
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 18px;
    }
    .status-bar {
      width: 100%;
      height: 6px;
      background: #eee;
      border-radius: 4px;
      overflow: hidden;
    }
    .progress {
      height: 6px;
      width: 0;
      background: #0b4f6c;
      transition: width 0.4s ease;
    }
    .status-message {
      font-size: 14px;
      color: #333;
      margin-top: 10px;
    }

    @media (max-width: 600px) {
      .toolbar { flex-wrap: wrap; bottom: 10px; right: 10px; }
      .toolbar button { font-size: 16px; margin: 4px; }
    }

    @media print {
      body::before {
        content: "‚ö† Printing of this document is restricted. Redirecting to policy page...";
        display: block;
        text-align: center;
        color: #c00;
        font-size: 20px;
        margin-top: 40vh;
      }
      body *:not(::before) { display: none !important; }
    }

    /* Themes */
    body.light { background: #f4f6fa; color: #222; }
    body.dark { background: #111; color: #eee; }
    body.dragon { background: #250000; color: #ffcc00; }
    body.forest { background: #013220; color: #d0ffd0; }
    body.ocean { background: #001f3f; color: #aee7ff; }
    body.midnight { background: #0a0a23; color: #c2d3ff; }
  </style>
</head>
<body class="light">

  <header>üìò Akshat Network Hub ‚Äì Learning Club Secure PDF Viewer</header>

  <div id="pdf-viewer" href="https://akshat-881236.github.io/Quizzone/Documentary/Quizzone_Owner_Message.pdf"></div>

  <!-- Floating Toolbar -->
  <div class="toolbar">
    <button id="prevPage">‚¨ÖÔ∏è</button>
    <button id="nextPage">‚û°Ô∏è</button>
    <button id="zoomOut">‚ûñ</button>
    <button id="zoomIn">‚ûï</button>
    <button id="modeToggle">üìñ</button>
    <button id="themeToggle">üé®</button>
    <button id="download-btn">üíæ</button>
  </div>

  <!-- Overlay for Processing -->
  <div id="status-overlay">
    <div class="status-box">
      <div class="status-step">Processing...</div>
      <div class="status-bar"><div class="progress"></div></div>
      <div class="status-message">Initializing...</div>
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    const pdfContainer = document.getElementById("pdf-viewer");
    const pdfUrl = pdfContainer.getAttribute("href");
    const logoUrl = "/LearningClub-Key-of-Success-Learning-Point/Assets/Icons/Icon.png";
    const { jsPDF } = window.jspdf;
    const pdfjsLib = window["pdfjs-dist/build/pdf"];
    pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js";

    let pdfDoc = null, renderedPages = [], currentPage = 1, scale = 1.2, viewMode = "scroll";
    const logoImage = new Image(); logoImage.src = logoUrl;
    const themes = ["light","dark","dragon","forest","ocean","midnight"];
    let currentThemeIndex = 0;

    logoImage.onload = async () => renderPDF();

    async function renderPDF() {
      pdfDoc = await pdfjsLib.getDocument(pdfUrl).promise;
      renderAllPages();
    }

    async function renderAllPages() {
      pdfContainer.innerHTML = "";
      renderedPages = [];
      const total = pdfDoc.numPages;

      for (let i = 1; i <= total; i++) {
        const page = await pdfDoc.getPage(i);
        const viewport = page.getViewport({ scale });
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = viewport.width;
        canvas.height = viewport.height;
        await page.render({ canvasContext: ctx, viewport }).promise;
        applyWatermarks(canvas, logoImage);
        canvas.dataset.page = i;
        pdfContainer.appendChild(canvas);
        renderedPages.push(canvas);
      }
      updateBookView();
    }

    function applyWatermarks(canvas, logo) {
      const ctx = canvas.getContext("2d");
      ctx.save();
      ctx.globalAlpha = 0.15;
      ctx.font = "bold 36px Inter";
      ctx.fillStyle = "#0b4f6c";
      ctx.translate(canvas.width / 2, canvas.height / 2);
      ctx.rotate(-Math.PI / 4);
      const text = "¬© Akshat Network Hub";
      const spacing = 200;
      ctx.fillText(text, -250, -spacing);
      ctx.fillText(text, -250, 0);
      ctx.fillText(text, -250, spacing);
      ctx.restore();

      const logoSize = 80;
      ctx.globalAlpha = 0.35;
      ctx.drawImage(logo, canvas.width - logoSize - 20, canvas.height - logoSize - 20, logoSize, logoSize);
      ctx.globalAlpha = 1;
    }

    function updateBookView() {
      renderedPages.forEach(c => c.style.display = (viewMode === "book" ? "none" : "block"));
      if (viewMode === "book") renderedPages[currentPage - 1].style.display = "block";
    }

    document.getElementById("prevPage").onclick = () => {
      if (viewMode === "book" && currentPage > 1) {
        currentPage--; updateBookView();
      }
    };
    document.getElementById("nextPage").onclick = () => {
      if (viewMode === "book" && currentPage < renderedPages.length) {
        currentPage++; updateBookView();
      }
    };
    document.getElementById("zoomIn").onclick = () => { scale += 0.2; renderAllPages(); };
    document.getElementById("zoomOut").onclick = () => { if (scale > 0.6) scale -= 0.2; renderAllPages(); };
    document.getElementById("modeToggle").onclick = () => {
      viewMode = (viewMode === "scroll") ? "book" : "scroll"; updateBookView();
    };
    document.getElementById("themeToggle").onclick = () => {
      currentThemeIndex = (currentThemeIndex + 1) % themes.length;
      document.body.className = themes[currentThemeIndex];
    };

    // Swipe gestures
    let startX = 0;
    pdfContainer.addEventListener("touchstart", e => startX = e.touches[0].clientX);
    pdfContainer.addEventListener("touchend", e => {
      let diff = e.changedTouches[0].clientX - startX;
      if (viewMode === "book") {
        if (diff < -50 && currentPage < renderedPages.length) currentPage++;
        if (diff > 50 && currentPage > 1) currentPage--;
        updateBookView();
      }
    });

    // Download with progress
    const statusOverlay = document.getElementById("status-overlay");
    const progress = document.querySelector(".progress");
    const stepTitle = document.querySelector(".status-step");
    const stepMsg = document.querySelector(".status-message");
    const steps = [
      { msg: "Preparing PDF...", color: "#0b4f6c" },
      { msg: "Rendering pages...", color: "#1597e5" },
      { msg: "Applying watermark...", color: "#f4a261" },
      { msg: "Building final file...", color: "#2a9d8f" },
      { msg: "Finalizing & downloading...", color: "#264653" }
    ];

    async function downloadPDFWithWatermark() {
      statusOverlay.style.display = "flex";
      const totalSteps = steps.length;
      const doc = new jsPDF();
      for (let i = 0; i < steps.length; i++) {
        const s = steps[i];
        progress.style.background = s.color;
        progress.style.width = `${((i + 1) / totalSteps) * 100}%`;
        stepTitle.textContent = `Step ${i + 1} of ${totalSteps}`;
        stepMsg.textContent = `${s.msg} (${Math.round(((i + 1) / totalSteps) * 100)}%)`;
        await new Promise(r => setTimeout(r, 700));
      }
      for (let i = 0; i < renderedPages.length; i++) {
        const img = renderedPages[i].toDataURL("image/png");
        doc.addImage(img, "PNG", 0, 0, 210, 297);
        if (i < renderedPages.length - 1) doc.addPage();
      }
      /* Trigger download and save pdf with Title of the document or Custom Title if User Set when he clicks the download button */
      /* First ask user for custom title */
      let customTitle = prompt("Enter a title for the downloaded PDF:", "Quizzone_Manual");
      if (!customTitle || customTitle.trim() === "") { customTitle = "Quizzone_Manual"; }
      doc.save(`${customTitle}.pdf`);
      stepMsg.textContent = "‚úÖ Completed successfully!";
      setTimeout(() => { statusOverlay.style.display = "none"; progress.style.width = "0"; }, 1000);
    }
    document.getElementById("download-btn").onclick = downloadPDFWithWatermark;

    // Print restriction
    const redirectToPolicy = () => {
      const currentPage = encodeURIComponent(window.location.pathname);
      window.location.href = `/LearningClub-Key-of-Success-Learning-Point/No_print.htm?from=${currentPage}`;
    };
    window.addEventListener("beforeprint", e => { e.preventDefault(); window.stop(); redirectToPolicy(); });
    document.addEventListener("keydown", e => {
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "p") { e.preventDefault(); redirectToPolicy(); }
    });
    window.addEventListener("contextmenu", e => {
      if (e.target.tagName.toLowerCase().includes("canvas")) {
        e.preventDefault(); alert("Printing of this document is restricted by policy.");
      }
    });
    window.matchMedia("print").addEventListener("change", mql => {
      if (mql.matches) redirectToPolicy();
    });
  </script>
  <script>
/* ============================================================
   UPGRADE 1: FAB-LIKE TOOLBAR (EXPAND / COLLAPSE)
   ============================================================ */

(function () {
  const toolbar = document.querySelector(".toolbar");
  if (!toolbar) return;

  toolbar.style.transition = "all 0.35s ease";
  toolbar.style.overflow = "hidden";
  toolbar.style.width = "48px";
  toolbar.style.padding = "6px";

  let expanded = false;

  const expandToolbar = () => {
    if (expanded) return;
    toolbar.style.width = "auto";
    toolbar.style.padding = "6px 12px";
    toolbar.classList.add("expanded");
    expanded = true;
  };

  const collapseToolbar = () => {
    if (!expanded) return;
    toolbar.style.width = "48px";
    toolbar.style.padding = "6px";
    toolbar.classList.remove("expanded");
    expanded = false;
  };

  toolbar.addEventListener("mouseenter", expandToolbar);
  toolbar.addEventListener("mouseleave", collapseToolbar);

  // Mobile touch support
  toolbar.addEventListener("click", () => {
    expanded ? collapseToolbar() : expandToolbar();
  });
})();

/* ============================================================
   UPGRADE 2: SECURITY & REDIRECTION HARDENING
   ============================================================ */

(function () {
  const redirectViolation = (reason) => {
    console.warn("Security Policy Triggered:", reason);
    const from = encodeURIComponent(window.location.pathname);
    window.location.href =
      `/LearningClub-Key-of-Success-Learning-Point/No_print.htm?from=${from}&reason=${encodeURIComponent(reason)}`;
  };

  /* --------- 1. BLOCK SCREENSHOT KEYS --------- */
  document.addEventListener("keydown", (e) => {
    const key = e.key.toLowerCase();

    // Print Screen
    if (key === "printscreen") {
      e.preventDefault();
      redirectViolation("Screenshot attempt detected");
    }

    // Windows Snipping Tool / macOS screenshot combos
    if (
      (e.metaKey && e.shiftKey && ["3", "4", "5"].includes(key)) ||
      (e.ctrlKey && e.shiftKey && key === "s")
    ) {
      e.preventDefault();
      redirectViolation("Screen capture shortcut blocked");
    }
  });

  /* --------- 2. VISIBILITY / TAB SWITCH DETECTION --------- */
  document.addEventListener("visibilitychange", () => {
    if (document.hidden) {
      redirectViolation("Tab switch or background activity detected");
    }
  });

  window.addEventListener("blur", () => {
    redirectViolation("Window focus lost");
  });

  /* --------- 3. BLOCK NEW TAB / WINDOW OPENING --------- */
  const originalOpen = window.open;
  window.open = function () {
    alert("Opening new tabs or windows is restricted.");
    window.location.href = "/LearningClub-Key-of-Success-Learning-Point/Error/blocked.htm";
    redirectViolation("New tab or window blocked");
    return null;
  };

  /* --------- 4. IFRAME EMBED BLOCK (FRAME BUSTING) --------- */
  if (window.top !== window.self) {
    redirectViolation("Iframe embedding blocked");
    alert("This content cannot be displayed in an embedded frame.");
    alert("Redirecting to secure viewer...");
    window.top.location = window.self.location;
  }

  /* --------- 5. DEVTOOLS / INSPECT DETERRENCE --------- */
  document.addEventListener("keydown", (e) => {
    if (
      e.key === "F12" ||
      (e.ctrlKey && e.shiftKey && ["i", "j", "c"].includes(e.key.toLowerCase())) ||
      (e.ctrlKey && e.key.toLowerCase() === "u")
    ) {
      e.preventDefault();
      alert("Developer tools access is restricted.");
      /* Redirecting User to /LearningClub-Key-of-Success-Learning-Point/Error/permission.htm */
      alert("Redirecting to permission error page...");
      window.location.href = "/LearningClub-Key-of-Success-Learning-Point/Error/permission.htm";
      redirectViolation("Developer tools blocked");
    }
  });

  /* --------- 6. DISABLE TEXT SELECTION & COPY --------- */
  document.addEventListener("selectstart", e => e.preventDefault());
  document.addEventListener("copy", e => {
    e.preventDefault();
    alert("Copying content is restricted.");
    window.location.href = "/LearningClub-Key-of-Success-Learning-Point/Error/permission.htm";
    redirectViolation("Copy action blocked");
  });
  document.addEventListener("cut", e => {
    e.preventDefault();
    alert("Cutting content is restricted.");
    window.location.href = "/LearningClub-Key-of-Success-Learning-Point/Error/permission.htm";
    redirectViolation("Cut action blocked");
  });

})();

/* ============================================================
   Akshat Network Hub
   Rich Dynamic PDF Sections + Edge-style Sidebar
   ============================================================ */

(function () {

  /* ------------------------------------------------------------
     1. Inner CSS (Edge-like polish)
     ------------------------------------------------------------ */
  const style = document.createElement("style");
  style.innerHTML = `
    .page-content-section{
      max-width:920px;
      margin:32px auto;
      padding:26px 30px;
      background:linear-gradient(180deg,#ffffff,#f6f9fc);
      border-radius:14px;
      border:1px solid #e3e8ef;
      box-shadow:0 10px 28px rgba(0,0,0,0.08);
      font-family:Inter,system-ui,sans-serif;
    }

    .page-content-section h3{
      font-size:1.15rem;
      font-weight:700;
      color:#0b4f6c;
      margin:0 0 6px;
    }

    .page-content-section .meta{
      font-size:.8rem;
      color:#666;
      margin-bottom:14px;
    }

    .page-content-section p{
      font-size:.95rem;
      line-height:1.75;
      color:#222;
      margin:0 0 10px;
    }

    .chip{
      display:inline-block;
      background:#e8f2f8;
      color:#0b4f6c;
      padding:4px 10px;
      border-radius:20px;
      font-size:.75rem;
      font-weight:600;
      margin-right:6px;
    }

    /* Sidebar (Edge-style) */
    #pdf-dynamic-sidebar{
      position:fixed;
      top:50%;
      left:-280px;
      transform:translateY(-50%);
      width:280px;
      height:78vh;
      background:#0e3a52;
      color:#fff;
      padding:16px 14px;
      border-radius:0 18px 18px 0;
      box-shadow:0 10px 28px rgba(0,0,0,.55);
      transition:left .35s ease;
      z-index:1600;
      overflow-y:auto;
    }
    #pdf-dynamic-sidebar.open{ left:0; }

    #pdf-dynamic-sidebar h4{
      margin:0 0 14px;
      font-size:1.05rem;
      font-weight:700;
      letter-spacing:.3px;
    }

    .nav-group{
      margin-bottom:16px;
    }

    .nav-group-title{
      font-size:.75rem;
      text-transform:uppercase;
      letter-spacing:.12em;
      opacity:.7;
      margin-bottom:6px;
    }

    #pdf-dynamic-sidebar ul{
      list-style:none;
      padding:0;
      margin:0;
    }

    #pdf-dynamic-sidebar li{
      padding:9px 10px;
      margin-bottom:6px;
      border-radius:8px;
      cursor:pointer;
      font-size:.9rem;
      display:flex;
      justify-content:space-between;
      align-items:center;
      transition:background .25s;
    }

    #pdf-dynamic-sidebar li:hover{
      background:rgba(255,255,255,.14);
    }

    #pdf-dynamic-sidebar li.active{
      background:rgba(255,255,255,.25);
      font-weight:600;
    }

    .badge{
      background:rgba(255,255,255,.25);
      padding:2px 8px;
      border-radius:10px;
      font-size:.7rem;
    }

    #pdf-sidebar-handle{
      position:fixed;
      top:50%;
      left:0;
      transform:translateY(-50%);
      background:#0e3a52;
      color:#fff;
      padding:12px 8px;
      border-radius:0 8px 8px 0;
      cursor:pointer;
      z-index:1700;
      font-size:16px;
      box-shadow:0 4px 12px rgba(0,0,0,.4);
    }
  `;
  document.head.appendChild(style);

  /* ------------------------------------------------------------
     2. Rich Content Map (2-page PDF)
     ------------------------------------------------------------ */
  const pageContentMap = {
  1: {
    content: `
      <section class="page-content-section" id="section-page-1">
        <h3>üìò Owner Message & Project Identity</h3>
        <div class="meta">Quizzone ‚Ä¢ Akshat Network Hub</div>
        <span class="chip">Owner Message</span>
        <span class="chip">Education</span>
        <span class="chip">Open Web</span>
        <p>
          This page introduces <strong>Quizzone</strong>, an educational initiative
          developed under the Akshat Network Hub ecosystem. The owner message
          explains the motivation behind building a student-focused learning and
          assessment platform using open web technologies.
        </p>
        <p>
          Quizzone is designed to encourage curiosity, experimentation, and
          self-evaluation while maintaining transparency, simplicity, and
          accessibility for learners.
        </p>
      </section>
    `
  },

  2: {
    content: `
      <section class="page-content-section" id="section-page-2">
        <h3>üìú License & Usage Rights</h3>
        <div class="meta">MIT License ‚Ä¢ Open Source</div>
        <span class="chip">MIT</span>
        <span class="chip">Open Source</span>
        <p>
          This section outlines the <strong>MIT License</strong> applied to the
          Quizzone project. Users are permitted to use, copy, modify, merge,
          publish, and distribute the software with proper attribution.
        </p>
        <p>
          The license also clarifies that the software is provided ‚Äúas is‚Äù,
          without warranty, and that the author is not liable for misuse
          or damages.
        </p>
      </section>
    `
  },

  3: {
    content: `
      <section class="page-content-section" id="section-page-3">
        <h3>üß† Learning Scope & Objectives</h3>
        <div class="meta">Platform Goals ‚Ä¢ Learning Design</div>
        <span class="chip">Learning</span>
        <span class="chip">Assessment</span>
        <span class="chip">Practice</span>
        <p>
          This page describes the educational scope of Quizzone, focusing on
          knowledge reinforcement through quizzes, conceptual testing, and
          logical problem-solving.
        </p>
        <p>
          The platform is structured to support self-paced learning and
          continuous improvement rather than competitive ranking.
        </p>
      </section>
    `
  },

  4: {
    content: `
      <section class="page-content-section" id="section-page-4">
        <h3>üìä Supported Disciplines</h3>
        <div class="meta">Academic & Technical Domains</div>
        <span class="chip">Mathematics</span>
        <span class="chip">Aptitude</span>
        <span class="chip">Frontend</span>
        <p>
          Quizzone supports multiple learning disciplines including Mathematics,
          Discrete Mathematics, Logical Aptitude, and Frontend Development
          fundamentals.
        </p>
        <p>
          These categories are designed to help students strengthen both
          theoretical understanding and practical reasoning skills.
        </p>
      </section>
    `
  },

  5: {
    content: `
      <section class="page-content-section" id="section-page-5">
        <h3>‚öô Technical Notes & Limitations</h3>
        <div class="meta">Frontend Architecture ‚Ä¢ Usage Terms</div>
        <span class="chip">Frontend Only</span>
        <span class="chip">No Backend</span>
        <p>
          This section explains that Quizzone is implemented entirely using
          frontend technologies and does not rely on server-side databases
          or user tracking systems.
        </p>
        <p>
          It also reiterates that the project is intended for educational
          demonstration, experimentation, and learning purposes only.
        </p>
      </section>
    `
  }
};

/* ------------------------------------------------------------
     3. Inject Content Around PDF Pages
     ------------------------------------------------------------ */
  /* ------------------------------------------------------------
   Reliable Content Injection (Refresh-Safe)
   ------------------------------------------------------------ */
let lastCanvasCount = 0;
let stableTicks = 0;

const wait = setInterval(() => {
  const canvases = [...document.querySelectorAll("canvas[data-page]")];

  if (!canvases.length) return;

  // Check if canvas count stopped increasing
  if (canvases.length === lastCanvasCount) {
    stableTicks++;
  } else {
    stableTicks = 0;
    lastCanvasCount = canvases.length;
  }

  // Require stability for ~600ms
  if (stableTicks < 2) return;

  clearInterval(wait);

  const totalPages = canvases.length;

  Object.keys(pageContentMap)
    .map(n => parseInt(n, 10))
    .filter(n => !isNaN(n) && n <= totalPages)
    .sort((a, b) => a - b)
    .forEach(pageNum => {
      const html = pageContentMap[pageNum]?.content;
      if (!html) return;

      const block = document.createElement("div");
      block.innerHTML = html;

      if (pageNum === 1) {
        canvases[0].before(block);
      } else {
        const prev = canvases.find(
          c => Number(c.dataset.page) === pageNum - 1
        );
        prev?.after(block);
      }
    });

  buildSidebar(totalPages);
}, 300);



  /* ------------------------------------------------------------
     4. Edge-style Sidebar Navigation
     ------------------------------------------------------------ */
  function buildSidebar(totalPages) {
    const sidebar = document.createElement("div");
    sidebar.id = "pdf-dynamic-sidebar";
    sidebar.innerHTML = `
      <h4>üìë Document Map</h4>

      <div class="nav-group">
        <div class="nav-group-title">Pages</div>
        <ul id="page-nav"></ul>
      </div>

      <div class="nav-group">
        <div class="nav-group-title">Sections</div>
        <ul id="section-nav"></ul>
      </div>
    `;
    document.body.appendChild(sidebar);

    const handle = document.createElement("div");
    handle.id = "pdf-sidebar-handle";
    handle.textContent = "‚ò∞";
    document.body.appendChild(handle);

    handle.onclick = () => sidebar.classList.toggle("open");

    const pageUL = sidebar.querySelector("#page-nav");
    const secUL = sidebar.querySelector("#section-nav");

    for (let i = 1; i <= totalPages; i++) {
      const li = document.createElement("li");
      li.innerHTML = `Page ${i} <span class="badge">PDF</span>`;
      li.onclick = () => {
        document.querySelector(`canvas[data-page="${i}"]`)
          ?.scrollIntoView({ behavior:"smooth" });
        highlight(li, pageUL);
      };
      pageUL.appendChild(li);

      if (pageContentMap[i]) {
        const sli = document.createElement("li");
        sli.innerHTML = `Section ${i} <span class="badge">HTML</span>`;
        sli.onclick = () => {
          document.getElementById(`section-page-${i}`)
            ?.scrollIntoView({ behavior:"smooth" });
          highlight(sli, secUL);
        };
        secUL.appendChild(sli);
      }
    }

    function highlight(active, list){
      list.querySelectorAll("li").forEach(l=>l.classList.remove("active"));
      active.classList.add("active");
    }

    /* Touch swipe */
    let sx=0;
    document.addEventListener("touchstart",e=>sx=e.touches[0].clientX);
    document.addEventListener("touchend",e=>{
      const dx=e.changedTouches[0].clientX-sx;
      if(dx>90) sidebar.classList.add("open");
      if(dx<-90) sidebar.classList.remove("open");
    });
  }

})();

</script>
<script src="/LearningClub-Key-of-Success-Learning-Point/PageNotFound.min.js" defer></script>
</body>
</html>